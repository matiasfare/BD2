    PROCEDURE P_GENERAR_PRESTAMO(ID_SOL NUMBER, FECHA_DES NUMBER)
    IS
    --Declaracion de variables a utilizar

    V_SOL_ID NUMBER; --Para el id de la solicitud de credito
    V_SOL_PRESTAMO CRE_SOL_PRESTAMO%ROWTYPE
    M_ERROR VARCHAR2(30) --Variable para mensaje de error
    PRES_RECHAZADO EXCEPTION;
    V_CUOTAS PCK_PRESTAMO.T_CUOTAS;
    V_FECHA DATE; --VARIABLE PARA FECHA DESEMBOLSO
    indice number;
    V_CUOTA_INTERES NUMBER;
    V_PNUM NUMBER; --NUMERO DE PRESTAMO

|   E_INACTIVO EXCEPTION;--excepci칩n, se lanzar치 cuando el socio est치 inactivo
    BEGIN
    	V_FECHA := FECHA_DES;
	V_SOL_ID := ID_SOL;
      --buscar치 la solicitud del prestamo.
      SELECT * INTO V_SOL_PRESTAMO FROM CRE_SOL_PRESTAMO A
      	WHERE A.ID_SOL_CRED = V_SOL_ID;
      IF UPPER(V_SOL_PRESTAMO.SITUACION) != 'A' THEN
      	RAISE PRES_RECHAZADO;
      END IF;
      V_CUOTAS := PCK_PRESTAMO.F_CALCULAR_CUOTAS(V_SOL_PRESTAMO.MONTO_CONCEDIDO,
      	V_SOL_PRESTAMO.TASA_INTERES, V_SOL_PRESTAMO.PLAZO, V_FECHA);
      indice := V_CUOTAS.FIRST;

      V_CUOTA_INTERES:=0;
      
      WHILE indice <= V_CUOTAS.LAST LOOP
      	V_CUOTA_INTERES:=V_CUOTA_INTERES*V_CUOTAS(indice).interes;
      	indice := V_CUOTAS.NEXT(INDICE);
      END LOOP;

      V_PNUM:=SEQ_PRESTAMO.NEXTVAL; --NRO DE PRESTAMO
      DBMS_OUTPUT.PUT_LINE('INSERT CRE_PRESTAMO = ');
      INSERT INTO CRE_PRESTAMO
      VALUES(V_PNUM,SYSDATE,V_FECHA,NULL.V_SOL_PRESTAMO.MONTO_CONCEDIDO,V_CUOTAS_INTERES,0,0,'A',ID_SOL);
      DBMS_OUTPUT.PUT_LINE('SUCCESSFUL INSERTION ON CRE_PRESTAMO');

      DBMS_OUTPUT.PUT_LINE('INSERTING ON CRE_CUOTAS');
      indice := V_CUOTAS.FIRST;
      WHILE indice <= V_CUOTAS.LAST LOOP
      	INSERR INTO CRE_CUOTAS
      	VALUES(V_PNUM,indice,V_CUOTAS(indice).SALDO_CAPITAL,V_CUOTAS(indice).AMORTIZACION,
      	V_CUOTAS(indice).INTERES,V_CUOTAS(indice).SEGURO_VIDA,V_CUOTAS(indice).MONTO_CUOTA,V_CUOTAS(indice).FECHA_VENCIMIENTO);
      END LOOP;
      DBMS_OUTPUT.PUT_LINE('SUCCESSFUL INSERTION ON CRE_CUOTAS');

      COMMIT;

      EXCEPTION
      		WHEN PRES_RECHAZADO THEN
      			DBMS_OUTPUT.PUT_LINE(V_ERROR);
      		WHEN NO_DATA_FOUND THEN
      			DBMS_OUTPUT.PUT_LINE('solicitud Inexistente');
      END P_GENERAR_PRESTAMO;
/